---
name: agent-web-context
description: Call a running agent-web-context HTTP API (FastAPI/OpenAPI) by reading a persisted base_url, then discover available operations from the service OpenAPI schema.
---

# agent-web-context (OpenAPI)

## Workflow

1. Read `references/service.json` (if present) and get `base_url`.
2. If `base_url` is missing/empty:
   - Ask the user for the service base URL (example: `http://localhost:8000`).
   - Persist it by creating/updating `references/service.json`.
3. Dynamic discovery mode:
   - Ensure `references/openapi_cache/index.json` exists; if it doesn’t, run `scripts/refresh_openapi_cache.py` to generate it (and per-operation files).
   - Update the cache by re-running `scripts/refresh_openapi_cache.py`:
     - when `base_url` changes
     - when the service version changes or requests start failing due to drift
     - periodically if you’re unsure (it uses HTTP `ETag`/`If-None-Match` when available, so it’s cheap when unchanged)
   - Read `references/openapi_cache/index.json` to discover available operations, then open only the specific operation file(s) you need from `references/openapi_cache/operations/`.
4. Do not hardcode endpoint lists; treat the split OpenAPI cache as the source of truth.

## Notes

- `references/service.json` is user-specific and is not shipped in the repo; it is created/updated by `scripts/set_base_url.py` (or by the agent itself).
- `references/openapi_cache/` is generated by `scripts/refresh_openapi_cache.py` and should be treated as disposable.
